import { Nutrient } from "../models/nutrient.model.mjs";
export async function listNutrients(req,res,next){try{const{foodFdcId,nutrientId,limit=50,skip=0}=req.query;const f={};if(foodFdcId)f.foodFdcId=Number(foodFdcId);if(nutrientId)f.nutrientId=Number(nutrientId);const docs=await Nutrient.find(f).limit(Number(limit)).skip(Number(skip)).lean();res.json({data:docs});}catch(e){next(e)}}
export async function getNutrient(req,res,next){try{const{id}=req.params;const doc=await Nutrient.findById(id).lean();if(!doc)return res.status(404).json({error:'Not found'});res.json(doc);}catch(e){next(e)}}
export async function createNutrient(req,res,next){try{const b=req.body;if(!b?.foodFdcId)return res.status(400).json({error:'foodFdcId is required'});const created=await Nutrient.create(b);res.status(201).json(created);}catch(e){next(e)}}
export async function patchNutrient(req,res,next){try{const{id}=req.params;const up=await Nutrient.findByIdAndUpdate(id,{$set:req.body},{new:true});if(!up)return res.status(404).json({error:'Not found'});res.json(up);}catch(e){next(e)}}
export async function deleteNutrient(req,res,next){try{const{id}=req.params;const rem=await Nutrient.findByIdAndDelete(id);if(!rem)return res.status(404).json({error:'Not found'});res.json({ok:true});}catch(e){next(e)}}